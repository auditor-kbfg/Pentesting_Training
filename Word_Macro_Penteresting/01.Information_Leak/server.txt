# 컴퓨터 정보를 가져와서 result.txt에 저장하는 PowerShell 스크립트

# 결과 파일 경로 설정
$resultFilePath = "C:\Temp\result.txt"

# 시스템 정보 가져오기
$systemInfo = wmic /output:"$resultFilePath" os get Caption,Version,BuildNumber,InstallDate
# 사용자 정보 가져오기
$userInfo = wmic /append:"$resultFilePath" useraccount get name,fullname
# 네트워크 정보 가져오기
$networkInfo = wmic /append:"$resultFilePath" nic get Name,MACAddress,Speed

# 결과를 화면에 출력
Write-Output "컴퓨터 정보 가져오기 완료"

# 결과 파일의 경로 출력
Write-Output "결과는 $resultFilePath 에 저장되었습니다."

# 결과 파일 읽기
$resultContent = Get-Content $resultFilePath -Raw

# POST 요청 보내기
Invoke-RestMethod -Uri "http://127.0.0.1:8000" -Method Post -Body $resultContent
